<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Kilimanjaro</title>
<link rel="icon" type="images/kili_logo.png" href="images/kili_logo.png" />

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
  /* Existing Styles ... (keep all your previous styles here) */

  /* Modal Styles */
  #announcement-modal {
    display: none; /* Hidden by default */
    position: fixed;
    z-index: 999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.7);
  }

  #announcement-modal .modal-content {
    background-color: #4e0506;
    margin: 10% auto;
    padding: 20px;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
    color: white;
    text-align: left;
    font-size: 18px;
    position: relative;
  }

  #announcement-modal .close-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    color: white;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }

  #announcement-modal .close-btn:hover {
    color: #ccc;
  }

  #announcement-modal h2 {
    text-align: center;
    margin-bottom: 15px;
  }

  #announcement-modal p {
    margin: 10px 0;
    line-height: 1.4;
  }
</style>

<!-- FontAwesome for social icons -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
</head>
<body>

<!-- Header, Title, Carousel, Nav, Description, Images, Map, Footer (unchanged) -->
<!-- ... copy your existing HTML content here ... -->

<!-- Announcement Modal -->
<div id="announcement-modal">
  <div class="modal-content" id="modal-content">
    <span class="close-btn" id="close-modal">&times;</span>
    <h2>Announcements</h2>
    <div id="modal-announcements"></div>
  </div>
</div>

<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyDhl8-z01pNxtiL6kWwmla79OFzsOamHnA",
    authDomain: "kilimanjaro-28f6d.firebaseapp.com",
    projectId: "kilimanjaro-28f6d",
    storageBucket: "kilimanjaro-28f6d.firebasestorage.app",
    messagingSenderId: "1034940817803",
    appId: "1:1034940817803:web:51be29aeff42e296870f8e",
    measurementId: "G-BEL0CY2F31"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Fetch announcements (last 3 days)
  const modal = document.getElementById('announcement-modal');
  const modalContent = document.getElementById('modal-announcements');
  const closeBtn = document.getElementById('close-modal');

  db.collection("announcements").orderBy("timestamp", "desc").get().then(snapshot => {
    const now = new Date();
    let hasAnnouncement = false;
    snapshot.forEach(doc => {
      const data = doc.data();
      const created = data.timestamp.toDate();
      const diffDays = (now - created)/(1000*60*60*24);
      if(diffDays <= 3){
        hasAnnouncement = true;
        const p = document.createElement('p');
        p.innerText = data.text;
        modalContent.appendChild(p);
      }
    });
    if(hasAnnouncement){
      modal.style.display = "block";
    }
  });

  // Close modal
  closeBtn.onclick = () => {
    modal.style.display = "none";
  };

  // Close if user clicks outside modal content
  window.onclick = (event) => {
    if(event.target == modal){
      modal.style.display = "none";
    }
  };

  // Hamburger & Carousel scripts (existing)
  function toggleMenu() {
    const dropdown = document.getElementById('dropdown-menu');
    dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
  }

  const track = document.getElementById('carousel-track');
  const slides = Array.from(track.children);
  let currentIndex = 0;

  function updateCarousel() {
    const slideWidth = slides[0].getBoundingClientRect().width;
    track.style.transform = `translateX(-${currentIndex * slideWidth}px)`;
  }

  function nextSlide() {
    currentIndex = (currentIndex + 1) % slides.length;
    updateCarousel();
  }

  function prevSlide() {
    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
    updateCarousel();
  }

  window.addEventListener('resize', updateCarousel);
  updateCarousel();
</script>

</body>
</html>
